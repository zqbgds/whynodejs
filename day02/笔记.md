## 全局对象和模块化开发（⼀）

#### 一、Node程序传递参数

正常情况下执行一个node程序，直接在命令行输入 node+文件名（要包含正确的路径）即可，如：

```
node index.js
```



但是在某些情况下执行node程序的过程中，我们可能希望给node传递一些参数，如：

```
node index.js env=development coderwhy
```



如果我们像上面这样使用程序，就意味着我们需要在程序中获取到传递的参数

- 获取的参数其实是存储在名为process的内置对象中的
- 如果我们直接打印这个对象，它里面是包含特别多的信息的
- 包括一些版本、操作系统等相关信息后面会逐个讲解到

```
node index.js env=development coderwhy
```



index.js文件代码：

```
console.log(process)
```



这里我们现在只需要找到其中的argv属性，我们发现它是一个数组，里面包含我们需要的参数



将参数内容打印出来index.js：

```
console.log(process.argv[2])
console.log(process.argv[3])
process.argv.forEach(item => {
	console.log(item)
})
```



#### 二、Node输出内容的方式

node中我们一般使用console.log()输出

使用console.clear()清空控制台内容

使用console.trace()打印函数的调用栈等

console还包含很多很多方法，如：

+ console.debug
+ console.info
+ console.time
+ console.timeEnd
+ console.group

等等。具体可以参考node官方文档

https://nodejs.org/dist/latest-v16.x/docs/api/console.html



#### 三、常见的全局对象

**特殊的全局对象**

`__dirname`、`__filename`、`exports`、`module`、`require`这几个变量在每个模块都有，看起来像全局变量，实际只是每个模块都有，看起来像全局变量，他们在命令行交互（REPL）中是不可以使用的。

```
console.log(__dirname)
console.log(exports)
```

在REPL中直接打印这些变量会报一个not defined的错误，这些变量在后面的章节中都会做详细的介绍

**常见的全局对象**

1. process对象

   提供了node进程中相关的信息，比如node的运行环境，参数信息等。

2. console对象

   提供了简单的调试控制台

3. 定时器函数

   | 函数及参数                            | 作用                                                         |
   | ------------------------------------- | ------------------------------------------------------------ |
   | setTimeout(callback,delay[,...args])  | callback在delay毫秒后执行一次                                |
   | setInterval(callback,delay[,...args]) | callback每隔delay毫秒重复执行一次                            |
   | setImmediate(callback[,...args])      | callback I/O事件后的回调，“立即”执行，它和setTimeout(callback,0)之间是有区别的，它涉及到事件循环阶段的问题，会在后面详细讲解。 |
   | process.nextTick(callback[,...args])  | 添加到下一次tick队列中，也会在事件循环中详细讲解。           |

**global对象**

在终端中输入node回车，进入REPL然后直接输入global.（注意后面有点），然后按两次Tab键，可以查看global包含的全部信息，如下图，这里注意只运行命令`console.log(global)`不能查看全部信息。

![global全局对象](..\images\60cca82c30c40.png)

可以看到，之前说到的所有对象几乎都是global的属性，这里的global和浏览器运行javascript时的window对象很像。不同的是，下面的例子是打印不出global.name的，而在浏览器下的window是可以的。

```
var name = "coderwhy"
console.log(name)
console.log(global.name)
```

这是因为在node中，每个文件它的本质都是一个模块，当我定义一个变量的时候，实际上是在这个模块上定义的。不能随便把它放在global上，会造成多个文件上的变量覆盖。